{% extends "base.html" %}

{% block title %}{{ page.meta.title }} - {{ config.site.title }}{% endblock %}
{% block meta_description %}{{ page.meta.description or config.site.description }}{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-6 lg:px-8 py-12 md:py-20">

    <div class="grid lg:grid-cols-12 gap-12">
        {% if sidebar_items %}
        <!-- Sidebar Navigation -->
        <aside class="lg:col-span-3 hidden lg:block">
            <div class="sticky top-32">
                {% if sidebar_title %}
                <h3
                    class="text-xs font-mono font-bold uppercase tracking-widest text-text-muted mb-6 pl-4 border-l-2 border-transparent">
                    {{ sidebar_title }}
                </h3>
                {% endif %}

                <nav class="space-y-1">
                    {% for item in sidebar_items %}
                    <a href="{{ item.url }}" class="block py-2 pl-4 border-l-2 transition-all text-sm
                              {% if item.active %}
                              border-accent-main text-accent-main font-bold
                              {% else %}
                              border-gray-100 text-text-muted hover:border-accent-main/50 hover:text-text-primary
                              {% endif %}">
                        {{ item.title }}
                    </a>
                    {% endfor %}

                    <a href="{{ back_url }}"
                        class="block mt-8 py-2 pl-4 text-xs font-mono text-gray-400 hover:text-text-primary transition-colors border-l-2 border-transparent hover:border-text-primary">
                        {{ back_label }}
                    </a>
                </nav>
            </div>
        </aside>

        <!-- Main Content with Sidebar -->
        <main class="lg:col-span-9">
            {% else %}
            <!-- Main Content Centered (No Sidebar) -->
            <main class="lg:col-span-8 lg:col-start-3">
                {% endif %}

                <!-- Header -->
                <header class="mb-12 border-b border-gray-200 pb-8">
                    <div class="flex items-center gap-4 mb-6">
                        <span class="text-xs font-mono font-bold uppercase tracking-widest text-accent-main">
                            {{ page.meta.section or "NOTE" }}
                        </span>
                        {% if page.meta.date %}
                        <span class="text-xs font-mono text-text-muted">
                            // {{ page.meta.date|format_date }}
                        </span>
                        {% endif %}
                    </div>

                    <h1 class="text-4xl md:text-5xl font-serif font-bold text-text-primary leading-tight mb-6">
                        {{ page.meta.title }}
                    </h1>

                    {% if page.meta.description %}
                    <p class="text-xl text-text-muted font-sans leading-relaxed max-w-3xl">
                        {{ page.meta.description }}
                    </p>
                    {% endif %}
                </header>

                <!-- Prose Content -->
                <!-- Prose Content -->
                <article class="prose prose-lg max-w-none 
                            prose-headings:font-serif prose-headings:text-text-primary 
                            prose-p:text-text-secondary prose-p:leading-relaxed 
                            prose-a:text-accent-blue prose-a:no-underline hover:prose-a:underline 
                            prose-strong:text-text-primary 
                            prose-code:text-accent-main prose-code:bg-gray-50 prose-code:px-1 prose-code:rounded
                            prose-pre:bg-[#0d1117] prose-pre:border prose-pre:border-gray-800
                            prose-ul:list-disc prose-ul:pl-6
                            prose-li:marker:text-accent-main prose-li:my-2">
                    {{ page.html|safe }}
                </article>

                <!-- Mobile Navigation (Bottom) -->
                {% if sidebar_items %}
                <div class="lg:hidden mt-16 border-t border-gray-200 pt-8">
                    <h3 class="text-xs font-mono font-bold uppercase tracking-widest text-text-muted mb-4">Read Next
                    </h3>
                    <div class="flex flex-col gap-2">
                        {% for item in sidebar_items %}
                        {% if not item.active %}
                        <a href="{{ item.url }}" class="text-sm py-2 text-accent-blue hover:underline">{{ item.title
                            }}</a>
                        {% endif %}
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

            </main>

    </div>

</div>
{% endblock %}